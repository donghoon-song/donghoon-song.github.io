{"componentChunkName":"component---src-templates-blog-post-js","path":"/development/2020-09-06---ì´ˆë³´-ì»¨íŠ¸ë¦¬ë·°í„°ì˜-Mocha-issue-í•´ê²°-ë„ì „ê¸°/","result":{"data":{"site":{"siteMetadata":{"title":"ì‚¬ì§„ì°ëŠ” ì›¹ ê°œë°œìì˜ ë¸”ë¡œê·¸","author":"Donghoon Song","siteUrl":"https://donghoon-song.github.io","comment":{"utterances":"donghoon-song/hoon-blog-comments"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"0eff6a29-4c3c-5222-b921-9027bb37db04","excerpt":"ì €ëŠ” í˜„ì¬ ì˜¤í”ˆì†ŒìŠ¤ ì»¨íŠ¸ë¦¬ë·°í†¤ MochaíŒ€ì—ì„œ ë©˜í‹°ë¡œ í™œë™í•˜ê³  ìˆìŠµë‹ˆë‹¤. Mochaì˜ #4433 ì´ìŠˆë¥¼ í•´ê²°í•˜ë©´ì„œ ë°°ìš´ ì ë“¤ì„ ì ì–´ë´¤ìŠµë‹ˆë‹¤. ìµœëŒ€í•œ rawí•˜ê²Œ, í˜¼ì£ë§ í•˜ë“¯ì´ ì˜ì‹ì˜ íë¦„ëŒ€ë¡œ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì–‘í•´ë¶€íƒë“œë¦½ë‹ˆë‹¤ :) ì €ì²˜ëŸ¼ ì˜¤í”ˆì†ŒìŠ¤ì— ëŒ€í•œ ê²½í—˜ì´ ë§ì´ ì—†ê³ , ë‘ë ¤ìš´ ì´ˆë³´ìë“¤ì—ê²Œ í° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤. Mocha does not pass â€œâ€”profâ€ parameter to Node and thus does not allow for profiling (#4433) Mochaâ€¦","html":"<p>ì €ëŠ” í˜„ì¬ ì˜¤í”ˆì†ŒìŠ¤ ì»¨íŠ¸ë¦¬ë·°í†¤ MochaíŒ€ì—ì„œ ë©˜í‹°ë¡œ í™œë™í•˜ê³  ìˆìŠµë‹ˆë‹¤. Mochaì˜ #4433 ì´ìŠˆë¥¼ í•´ê²°í•˜ë©´ì„œ ë°°ìš´ ì ë“¤ì„ ì ì–´ë´¤ìŠµë‹ˆë‹¤. ìµœëŒ€í•œ rawí•˜ê²Œ, í˜¼ì£ë§ í•˜ë“¯ì´ ì˜ì‹ì˜ íë¦„ëŒ€ë¡œ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì–‘í•´ë¶€íƒë“œë¦½ë‹ˆë‹¤ :) ì €ì²˜ëŸ¼ ì˜¤í”ˆì†ŒìŠ¤ì— ëŒ€í•œ ê²½í—˜ì´ ë§ì´ ì—†ê³ , ë‘ë ¤ìš´ ì´ˆë³´ìë“¤ì—ê²Œ í° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤.</p>\n<h1 id=\"mocha-does-not-pass-prof-parameter-to-node-and-thus-does-not-allow-for-profiling-4433\" style=\"position:relative;\"><a href=\"#mocha-does-not-pass-prof-parameter-to-node-and-thus-does-not-allow-for-profiling-4433\" aria-label=\"mocha does not pass prof parameter to node and thus does not allow for profiling 4433 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mocha does not pass â€œâ€”profâ€ parameter to Node and thus does not allow for profiling (#4433)</h1>\n<p><a href=\"https://github.com/mochajs/mocha/issues/4433\">Mocha does not pass â€œâ€”profâ€ parameter to Node and thus does not allow for profiling Â· Issue #4433 Â· mochajs/mocha</a></p>\n<p>mochaì—ì„œ Nodeì˜ <code class=\"language-text\">â€”prof</code> argumentë¥¼ ë„˜ê²¨ì¤¬ëŠ”ë° Nodeê°€ ì²˜ë¦¬í•˜ì§€ ëª»í•˜ëŠ” ì´ìŠˆì´ë‹¤.</p>\n<p>ë©˜í† ë‹˜ê»˜ì„œ <code class=\"language-text\">lib/cli/node-flags.js</code>ë¥¼ ì°¸ê³ í•˜ë¼ê³  í•´ì£¼ì…¨ë‹¤. ë§í¬ë¥¼ ì—´ì–´ë³´ë©´, nodeì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” flagì˜ ëª©ë¡ì´ ë³´ì¸ë‹¤.</p>\n<p><a href=\"https://nodejs.org/dist/latest-v12.x/docs/api/process.html#process_process_allowednodeenvironmentflags\">Node.js v14.9.0 Documentation</a></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>cli<span class=\"token operator\">/</span>node<span class=\"token operator\">-</span>flags<span class=\"token punctuation\">.</span>js\n\n<span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Some settings and code related to Mocha's handling of Node.js/V8 flags.\n * @private\n * @module\n */</span>\n\n<span class=\"token keyword\">const</span> nodeFlags <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>allowedNodeEnvironmentFlags<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>isMochaFlag<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./run-option-metadata'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì½”ë“œë¥¼ ë³´ë©´ <code class=\"language-text\">process.allowedNodeEnvironmentFlags</code>ì•ˆì— nodeì˜ flagë“¤ì´ ë“¤ì–´ìˆë‹¤. ê·¸ë¦¬ê³  <code class=\"language-text\">./lib/cli/run-option-metadata</code>ì•ˆì— mocha flagë“¤ì´ ë“¤ì–´ìˆë‹¤. <code class=\"language-text\">â€”-prof</code>ëŠ” ì´ ë‘ ê³³ì— ì†í•´ìˆì§€ ì•Šì•˜ë‹¤.</p>\n<p>ë°‘ìœ¼ë¡œ ë‚´ë ¤ê°€ë³´ë©´ ë‹¤ìŒ ì½”ë“œë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. <code class=\"language-text\">node</code>ì™€ <code class=\"language-text\">v8</code> í”Œë˜ê·¸ë¥¼ ì—¬ê¸°ì„œ ë”°ë¡œ ì²˜ë¦¬í•˜ëŠ”ê°€ë³´ë‹¤. ì´ ëª©ë¡ì— <code class=\"language-text\">â€”-prof</code>ê°€ ë¹ ì ¸ ìˆìœ¼ë‹ˆ ì¶”ê°€í•˜ë©´ ë˜ì§€ ì•Šì„ê¹Œ? ë¼ëŠ” ìƒê°ì´ ë¨¼ì € ë“¤ì—ˆë‹¤. ë‚´ê°€ í•´ì•¼í•˜ëŠ” ì¼ì€ <code class=\"language-text\">--prof</code> í”Œë˜ê·¸ë¥¼ Nodeê°€ ì²˜ë¦¬í•˜ë„ë¡ ì˜ ë„˜ê²¨ì£¼ëŠ” ì¼ì´ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<p><code class=\"language-text\">â€”-prof</code>ëŠ” <code class=\"language-text\">node --v8-options</code>ì„ ì‹¤í–‰í•˜ë©´ ë‚˜ì˜¤ëŠ” ì˜µì…˜ì´ê¸° ë•Œë¬¸ì´ë‹¤. <code class=\"language-text\">â€”es-staging</code>ë„ ì—¬ê¸°ì„œ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.  command ì°½ì—ì„œ ë³´ê¸° í˜ë“¤ë©´, ë‹¤ìŒ ê¸€ì—ì„œ ì°¾ì•„ë³´ë©´ ì‰½ë‹¤.</p>\n<p><a href=\"https://flaviocopes.com/node-runtime-v8-options/\">The Node.js Runtime v8 options list</a></p>\n<p>ë¨¼ì €, <code class=\"language-text\">isNodeFlag</code>ê°€ ì–´ë””ì„œ ì“°ì´ëŠ”ì§€ ì°¾ì•„ë³´ì•˜ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>cli<span class=\"token operator\">/</span>node<span class=\"token operator\">-</span>flags<span class=\"token punctuation\">.</span>js\n\n<span class=\"token comment\">/**\n * Mocha has historical support for various `node` and V8 flags which might not\n * appear in `process.allowedNodeEnvironmentFlags`.\n * These include:\n *   - `--preserve-symlinks`\n *   - `--harmony-*`\n *   - `--gc-global`\n *   - `--trace-*`\n *   - `--es-staging`\n *   - `--use-strict`\n *   - `--v8-*` (but *not* `--v8-options`)\n * @summary Whether or not to pass a flag along to the `node` executable.\n * @param {string} flag - Flag to test\n * @param {boolean} [bareword=true] - If `false`, we expect `flag` to have one or two leading dashes.\n * @returns {boolean} If the flag is considered a \"Node\" flag.\n * @private\n */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">isNodeFlag</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">flag<span class=\"token punctuation\">,</span> bareword <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>bareword<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// check if the flag begins with dashes; if not, not a node flag.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^--?</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// strip the leading dashes to match against subsequent checks</span>\n    flag <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^--?</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// check actual node flags from `process.allowedNodeEnvironmentFlags`,</span>\n    <span class=\"token comment\">// then historical support for various V8 and non-`NODE_OPTIONS` flags</span>\n    <span class=\"token comment\">// and also any V8 flags with `--v8-` prefix</span>\n    <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isMochaFlag</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> nodeFlags <span class=\"token operator\">&amp;&amp;</span> nodeFlags<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n    debugFlags<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n    <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?:preserve-symlinks(?:-main)?|harmony(?:[_-]|$)|(?:trace[_-].+$)|gc(?:[_-]global)?$|es[_-]staging$|use[_-]strict$|prof$|v8[_-](?!options).+?$)</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>\n      flag\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ë‹¤ìŒ íŒŒì¼ì—ì„œ <code class=\"language-text\">isNodeFlag</code>ë¥¼ ì°¾ì„ ìˆ˜ ìˆì—ˆê³ , <code class=\"language-text\">isNodeFlag</code>ê°€ trueì´ë©´ <code class=\"language-text\">nodeArgs</code>ì— ë¶™ì—¬ì£¼ëŠ” í˜•ì‹ì´ì—ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>cli<span class=\"token operator\">/</span>options<span class=\"token punctuation\">.</span>js\n\n<span class=\"token comment\">/**\n * Wrapper around `yargs-parser` which applies our settings\n * @param {string|string[]} args - Arguments to parse\n * @param {Object} defaultValues - Default values of mocharc.json\n * @param  {...Object} configObjects - `configObjects` for yargs-parser\n * @private\n * @ignore\n */</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">parse</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">args <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> defaultValues <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>configObjects</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// save node-specific args for special handling.</span>\n  <span class=\"token comment\">// 1. when these args have a \"=\" they should be considered to have values</span>\n  <span class=\"token comment\">// 2. if they don't, they just boolean flags</span>\n  <span class=\"token comment\">// 3. to avoid explicitly defining the set of them, we tell yargs-parser they</span>\n  <span class=\"token comment\">//    are ALL boolean flags.</span>\n  <span class=\"token comment\">// 4. we can then reapply the values after yargs-parser is done.</span>\n  <span class=\"token keyword\">const</span> nodeArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> args <span class=\"token operator\">:</span> args<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> arg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> pair <span class=\"token operator\">=</span> arg<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> flag <span class=\"token operator\">=</span> pair<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'isNodeFlag : '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">isNodeFlag</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNodeFlag</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        flag <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^--?</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> arg<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'='</span><span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">?</span> acc<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>flag<span class=\"token punctuation\">,</span> pair<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">:</span> acc<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>flag<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> acc<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> yargsParser<span class=\"token punctuation\">.</span><span class=\"token function\">detailed</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    configuration<span class=\"token punctuation\">,</span>\n    configObjects<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> defaultValues<span class=\"token punctuation\">,</span>\n    coerce<span class=\"token operator\">:</span> coerceOpts<span class=\"token punctuation\">,</span>\n    narg<span class=\"token operator\">:</span> nargOpts<span class=\"token punctuation\">,</span>\n    alias<span class=\"token operator\">:</span> aliases<span class=\"token punctuation\">,</span>\n    string<span class=\"token operator\">:</span> types<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    array<span class=\"token operator\">:</span> types<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">,</span>\n    number<span class=\"token operator\">:</span> types<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">,</span>\n    boolean<span class=\"token operator\">:</span> types<span class=\"token punctuation\">.</span>boolean<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>nodeArgs<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pair</span> <span class=\"token operator\">=></span> pair<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>ansi<span class=\"token punctuation\">.</span><span class=\"token function\">red</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>result<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// reapply \"=\" arg values from above</span>\n  nodeArgs<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    result<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì•„ë¬´ í…ŒìŠ¤íŠ¸ íŒŒì¼ì´ë‚˜ ì‹¤í–‰ì‹œì¼œì„œ, <code class=\"language-text\">â€”-es-staging</code> ì˜µì…˜ì„ ì¤„ ë•Œì™€ <code class=\"language-text\">â€”-prof</code> ì˜µì…˜ì„ ì¤„ ë•Œ ê²°ê³¼ê°€ ë˜‘ê°™ìœ¼ë©´ ë  ê²ƒì´ë¼ê³  ìƒê°í–ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./bin/mocha ./test/only/bdd.spec.js --es-staging\n\nconsole.log<span class=\"token punctuation\">(</span><span class=\"token string\">'isNodeFlag : '</span>, isNodeFlag<span class=\"token punctuation\">(</span>flag, <span class=\"token boolean\">false</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">'es-staging'</span>, <span class=\"token boolean\">true</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">]</span></code></pre></div>\n<p>ì´ ëª©ë¡ì— <code class=\"language-text\">â€”-prof</code>ê°€ ë¹ ì ¸ìˆìœ¼ë‹ˆ ì¶”ê°€í•´ì¤€ë‹¤. <code class=\"language-text\">â€”-prof</code>ëŠ” <code class=\"language-text\">mochaFlag</code>, <code class=\"language-text\">nodeFlag</code>, <code class=\"language-text\">debugFlag</code>ê°€ ì•„ë‹ˆë¯€ë¡œ <code class=\"language-text\">ë„¤ë²ˆì§¸ orë¬¸</code>ì—ì„œ ì²˜ë¦¬ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>cli<span class=\"token operator\">/</span>node<span class=\"token operator\">-</span>flags<span class=\"token punctuation\">.</span>js\n\n<span class=\"token comment\">/**\n * Mocha has historical support for various `node` and V8 flags which might not\n * appear in `process.allowedNodeEnvironmentFlags`.\n * These include:\n *   - `--preserve-symlinks`\n *   - `--harmony-*`\n *   - `--gc-global`\n *   - `--trace-*`\n *   - `--es-staging`\n *   - `--use-strict`\n *   - '--prof'\n *   - `--v8-*` (but *not* `--v8-options`)\n * @summary Whether or not to pass a flag along to the `node` executable.\n * @param {string} flag - Flag to test\n * @param {boolean} [bareword=true] - If `false`, we expect `flag` to have one or two leading dashes.\n * @returns {boolean} If the flag is considered a \"Node\" flag.\n * @private\n */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">isNodeFlag</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">flag<span class=\"token punctuation\">,</span> bareword <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>bareword<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// check if the flag begins with dashes; if not, not a node flag.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^--?</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// strip the leading dashes to match against subsequent checks</span>\n    flag <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^--?</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// check actual node flags from `process.allowedNodeEnvironmentFlags`,</span>\n    <span class=\"token comment\">// then historical support for various V8 and non-`NODE_OPTIONS` flags</span>\n    <span class=\"token comment\">// and also any V8 flags with `--v8-` prefix</span>\n    <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isMochaFlag</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> nodeFlags <span class=\"token operator\">&amp;&amp;</span> nodeFlags<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n    debugFlags<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n    <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?:preserve-symlinks(?:-main)?|harmony(?:[_-]|$)|(?:trace[_-].+$)|gc(?:[_-]global)?$|es[_-]staging$|use[_-]strict$|prof$|v8[_-](?!options).+?$)</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>\n      flag\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì‹¤í–‰ê²°ê³¼ ë˜‘ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./bin/mocha ./test/only/bdd.spec.js --prof\n\nconsole.log<span class=\"token punctuation\">(</span><span class=\"token string\">'isNodeFlag : '</span>, isNodeFlag<span class=\"token punctuation\">(</span>flag, <span class=\"token boolean\">false</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">[</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">'prof'</span>, <span class=\"token boolean\">true</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">]</span></code></pre></div>\n<p>ë™ì‘ì„ ì˜í•˜ëŠ”ì§€ ë” í™•ì‹¤íˆ í•˜ê³ ì ì°¾ì•„ë´¤ëŠ”ë°, profilingì„ í•˜ë©´ log fileì´ ì•„ì›ƒí’‹ ê²°ê³¼ë¡œ ë‚˜ì˜¨ë‹¤ê³  í•œë‹¤. ì˜ ë‚˜ì˜¤ê³  ìˆì—ˆë‹¤!</p>\n<p><a href=\"https://nodejs.org/en/docs/guides/simple-profiling/\">Easy profiling for Node.js Applications | Node.js</a></p>\n<blockquote>\n<p>Since we ran our application using the â€”prof option, a tick file was generated in the same directory as your local run of the application. It should have the form isolate-0xnnnnnnnnnnnn-v8.log (where n is a digit).</p>\n</blockquote>\n<div style=\"text-align: center\">\n<img src=\"https://user-images.githubusercontent.com/32301380/92322688-ba8b1500-f06d-11ea-84dd-0a1cd4f0268b.png\"><br>\n<span>profiling ì•„ì›ƒí’‹ íŒŒì¼ë“¤</span>\n</div>\n<p>ì¶”ê°€ì ìœ¼ë¡œ, ë©˜í† ë‹˜ê»˜ì„œ <code class=\"language-text\">./test/node-unit/cli/node-flags-spec.js</code> íŒŒì¼ì—ì„œ í…ŒìŠ¤íŠ¸ë„ ì‘ì„±í•˜ë©´ ì¢‹ì„ ê±° ê°™ë‹¤ê³  í•˜ì…¨ë‹¤. ê·¸ë˜ì„œ ì•„ë˜ í…ŒìŠ¤íŠ¸ êµ¬ë¬¸ê¹Œì§€ ì¶”ê°€í•´ì„œ prì„ ì‘ì„±í–ˆë‹¤ ğŸ™‚</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">it<span class=\"token punctuation\">(</span><span class=\"token string\">'should return true for \"prof\" itself'</span>, <span class=\"token function-name function\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  expect<span class=\"token punctuation\">(</span>isNodeFlag<span class=\"token punctuation\">(</span><span class=\"token string\">'prof'</span><span class=\"token punctuation\">)</span>, <span class=\"token string\">'to be true'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://github.com/mochajs/mocha/pull/4439\">Add support for node v8 option â€˜profâ€™ parameter (#4433) by Donghoon759 Â· Pull Request #4439 Â· mochajs/mocha</a></p>\n<p>ì²˜ìŒì—ëŠ” ë˜ê²Œ ë§‰ë§‰í–ˆëŠ”ë°, ì½”ë“œë¥¼ ë”°ë¼ê°€ë‹¤ë³´ë‹ˆ ì–´ë””ë¥¼ ìˆ˜ì •í•´ì•¼ ë ì§€ ì•Œ ìˆ˜ ìˆì—ˆê³ , node flagë¥¼ ì£¼ë©´ nodeê°€ ì²˜ë¦¬í•˜ë„ë¡ ë„˜ê¸°ëŠ”êµ¬ë‚˜, nodeì— profilingí•˜ëŠ” ì˜µì…˜ë„ ìˆêµ¬ë‚˜ í•˜ëŠ” ìƒˆë¡œìš´ ë‚´ìš©ë„ ë°°ìš¸ ìˆ˜ ìˆì–´ ì¢‹ì•˜ë‹¤. ì •ë§ í•˜ë©´ í• ìˆ˜ë¡ ì•Œì•„ê°€ëŠ” ê²Œ ë§ì•˜ê³ , mocha ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŠ” prì€ ì²˜ìŒì´ë¼ ìì‹ ê°ë„ ë¶™ì—ˆë‹¤!</p>","frontmatter":{"title":"[OpenSource] ì´ˆë³´ ì»¨íŠ¸ë¦¬ë·°í„°ì˜ Mocha issue í•´ê²° ë„ì „ê¸°","date":"September 06, 2020"}}},"pageContext":{"slug":"/development/2020-09-06---ì´ˆë³´-ì»¨íŠ¸ë¦¬ë·°í„°ì˜-Mocha-issue-í•´ê²°-ë„ì „ê¸°/","previous":{"fields":{"slug":"/development/2020-08-22---Husky-ì‚¬ìš©/"},"frontmatter":{"title":"[Husky] Git hook library Husky ì‚¬ìš©"}},"next":{"fields":{"slug":"/development/2020-09-09---ì´ˆë³´-ì»¨íŠ¸ë¦¬ë·°í„°ì˜-Nuxt-docs-PR-ë„ì „ê¸°/"},"frontmatter":{"title":"[OpenSource] ì´ˆë³´ ì»¨íŠ¸ë¦¬ë·°í„°ì˜ Nuxt docs PR ë„ì „ê¸°"}}}},"staticQueryHashes":["2486386679","3128451518"],"slicesMap":{}}