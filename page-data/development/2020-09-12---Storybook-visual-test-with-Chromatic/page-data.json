{"componentChunkName":"component---src-templates-blog-post-js","path":"/development/2020-09-12---Storybook-visual-test-with-Chromatic/","result":{"data":{"site":{"siteMetadata":{"title":"사진찍는 웹 개발자의 블로그","author":"Donghoon Song","siteUrl":"https://donghoon-song.github.io","comment":{"utterances":"donghoon-song/hoon-blog-comments"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"060b74d9-c845-5a0e-b6aa-21c34fa8359b","excerpt":"하라는 컴포넌트화는 안하고 테스팅만 찾아보는 당신은 대체… Storybook Tutorial에서 제시하는 테스트는 크게 세가지가 있다. Visual tests : 직접 보고 의도대로 모양이 나왔는지 체크하는 방법 Snapshot tests : Storybook이 렌더된 markup의 snapshot을 찍어서 비교한다. Unit tests : Jest를 사용해 같은 인풋에 대해 같은 아웃풋이 나오는지 체크한다. 하지만 앞서 언급했던 방법들은 UI bug를 감지하기 힘들다. UI bug…","html":"<h3 id=\"하라는-컴포넌트화는-안하고-테스팅만-찾아보는-당신은-대체\" style=\"position:relative;\"><a href=\"#%ED%95%98%EB%9D%BC%EB%8A%94-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%ED%99%94%EB%8A%94-%EC%95%88%ED%95%98%EA%B3%A0-%ED%85%8C%EC%8A%A4%ED%8C%85%EB%A7%8C-%EC%B0%BE%EC%95%84%EB%B3%B4%EB%8A%94-%EB%8B%B9%EC%8B%A0%EC%9D%80-%EB%8C%80%EC%B2%B4\" aria-label=\"하라는 컴포넌트화는 안하고 테스팅만 찾아보는 당신은 대체 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>하라는 컴포넌트화는 안하고 테스팅만 찾아보는 당신은 대체…</h3>\n<p>Storybook Tutorial에서 제시하는 테스트는 크게 세가지가 있다.</p>\n<ol>\n<li>Visual tests : 직접 보고 의도대로 모양이 나왔는지 체크하는 방법</li>\n<li>Snapshot tests : Storybook이 렌더된 markup의 snapshot을 찍어서 비교한다.</li>\n<li>Unit tests : Jest를 사용해 같은 인풋에 대해 같은 아웃풋이 나오는지 체크한다.</li>\n</ol>\n<p>하지만 앞서 언급했던 방법들은 UI bug를 감지하기 힘들다. UI bug는 경우에 따라 굉장히 미미한 차이일 수도 있기 때문에, Visual tests는 너무 수동이고, Snapshot tests는 UI에 적용했을 때 너무 많은 false positive(실제론 false인데 positive라고 나오는)를 발생시키며, pixel-level unit tests는 의미가 없다. 그래서 Storybook은 <code class=\"language-text\">visual regression tests</code>를 제안한다.</p>\n<h2 id=\"visual-regression-testing-for-storybook\" style=\"position:relative;\"><a href=\"#visual-regression-testing-for-storybook\" aria-label=\"visual regression testing for storybook permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Visual regression testing for Storybook</h2>\n<p><code class=\"language-text\">Visual regression tests</code>는 렌더링된 모양의 차이를 잡아내도록 디자인되었다. 모든 스토리의 스크린샷을 찍어서, 커밋별 변화점을 잡아낸다. 많은 visual regression testing 도구가 있지만, Storybook에선 클라우드에서 테스트를 할 수 있는 <code class=\"language-text\">Chromatic</code>을 제안한다!</p>\n<h2 id=\"setup-visual-regression-testing\" style=\"position:relative;\"><a href=\"#setup-visual-regression-testing\" aria-label=\"setup visual regression testing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup visual regression testing</h2>\n<h3 id=\"bring-git-up-to-date\" style=\"position:relative;\"><a href=\"#bring-git-up-to-date\" aria-label=\"bring git up to date permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bring git up to date</h3>\n<p>먼저 storybook project의 git 저장소가 있어야 합니다! 기존에 만들었으면 상관없겠죠?</p>\n<h3 id=\"get-chromatic\" style=\"position:relative;\"><a href=\"#get-chromatic\" aria-label=\"get chromatic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Get Chromatic</h3>\n<ul>\n<li>chromatic을 설치해줍니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D chromatic</code></pre></div>\n<ul>\n<li>chromatic에서 git으로 로그인을 하고, repository를 추가합니다.</li>\n</ul>\n<p><a href=\"https://www.chromatic.com/start?invite-token=dnjk1zik&#x26;utm_source=https://learnstorybook.com&#x26;utm_medium=tutorial&#x26;utm_campaign=learnstorybook\">Chromatic</a></p>\n<ul>\n<li>그러면 <code class=\"language-text\">project-token</code>을 받을 수 있고, 해당 명령어를 실행해 deploy합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx chromatic --project-token<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>project-token<span class=\"token operator\">></span></code></pre></div>\n<details>\n<summary>package.json에 build-storybook이 없다고 한다면?</summary>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"build-storybook\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"build-storybook\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n</details>\n<p>그러고 나서 chromatic에 들어가면 정상적으로 배포된 것을 볼 수 있습니다.\n<img src=\"https://user-images.githubusercontent.com/32301380/92944506-03d4cd80-f48f-11ea-8b6b-9a6ea1befa5b.png\" alt=\"image\"></p>\n<p>진짜 chromatic의 기능은 여기부터 시작입니다. 아무 변화나 주고 다시 배포를 해봅시다. 저는 버튼의 background-color를 파랑에서 빨강으로 바꿔봤습니다.\n그럼 다음처럼 변경점이 감지되었음을 보여줍니다. Review changes 버튼을 클릭해서 들어가봅시다.\n<img src=\"https://user-images.githubusercontent.com/32301380/92947467-ff121880-f492-11ea-9062-499e544c7400.png\" alt=\"image\"></p>\n<p>다음 처럼 UI 변경점을 보여줍니다. 바뀐 지점이 연두색으로 덮혀있습니다. DOM에서도 바뀐게 감지되었죠.\n<img src=\"https://user-images.githubusercontent.com/32301380/92947491-0afdda80-f493-11ea-8b97-186ef3ddd49a.png\" alt=\"image\"></p>\n<p>이렇게 배포할 때마다 UI의 변경점을 감지하고, 둘 중에 하나를 선택해서 적용할 수 있습니다. 내가 작업한 결과물이 기존것과 잘 매치되는지, 잘 변경되는지 등을 손쉽게 테스트할 수 있어 정말 유용한 서비스 같습니다.</p>\n<h2 id=\"manage\" style=\"position:relative;\"><a href=\"#manage\" aria-label=\"manage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manage</h2>\n<p>PR을 보냈을 때에도 똑같이 테스트를 해 볼 수 있네요! 정말 유용합니다.\n<img src=\"https://user-images.githubusercontent.com/32301380/92945175-e0f6e900-f48f-11ea-998c-0c75244dc55a.png\" alt=\"image\"></p>\n<p>브라우저별 테스트를 제공합니다. 제일 말썽인 IE가 포함되어 있네요. IE를 누르면 다음 가격 정책이 뜹니다.\n<img src=\"https://user-images.githubusercontent.com/32301380/92944752-5910df00-f48f-11ea-966b-49d3bec1e4b4.png\" alt=\"image\"></p>\n<p>그렇다면 가격 정책에 대해서 알아봅시다!\n<img src=\"https://user-images.githubusercontent.com/32301380/92944786-65953780-f48f-11ea-81bb-6642f8f3a1eb.png\" alt=\"image\">\n그만 알아봅시다 ㅠㅠ 너무 비싸네요. 그런데 Free인 5000 snapshots도 다 못 채울 것 같습니다.</p>","frontmatter":{"title":"[Storybook] Storybook visual test with Chromatic","date":"September 12, 2020"}}},"pageContext":{"slug":"/development/2020-09-12---Storybook-visual-test-with-Chromatic/","previous":{"fields":{"slug":"/development/2020-09-09---초보-컨트리뷰터의-Nuxt-docs-PR-도전기/"},"frontmatter":{"title":"[OpenSource] 초보 컨트리뷰터의 Nuxt docs PR 도전기"}},"next":{"fields":{"slug":"/development/2020-10-01---Vue-Storybook-addon-docs-사용해서-docs-만들기/"},"frontmatter":{"title":"[Storybook] Vue Storybook addon-docs 사용해서 docs 만들기"}}}},"staticQueryHashes":["2486386679","3128451518"],"slicesMap":{}}